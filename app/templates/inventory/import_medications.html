{% extends "base.html" %}

{% block content %}
<div class="row mb-4">
    <div class="col">
        <h1>Import Medications</h1>
    </div>
    <div class="col-auto">
        <a href="{{ url_for('inventory.generate_sample_excel') }}" class="btn btn-info">
            <i class="bi bi-download"></i> Download Sample
        </a>
    </div>
</div>

<div class="row">
    <div class="col-md-6">
        <div class="card">
            <div class="card-header">
                <h5 class="card-title">Import from Excel</h5>
            </div>
            <div class="card-body">
                <form method="POST" action="{{ url_for('inventory.import_medications') }}" enctype="multipart/form-data">
                    <div class="mb-3">
                        <label for="file" class="form-label">Excel File</label>
                        <input type="file" class="form-control" id="file" name="file" accept=".xlsx,.xls" required>
                        <div class="form-text">Supported formats: .xlsx, .xls</div>
                    </div>
                    <button type="submit" class="btn btn-success">
                        <i class="bi bi-upload"></i> Import Medications
                    </button>
                </form>
            </div>
        </div>
    </div>
    <div class="col-md-6">
        <div class="card">
            <div class="card-header">
                <h5 class="card-title">Excel Format Requirements</h5>
            </div>
            <div class="card-body">
                <p>Your Excel file should have the following columns:</p>
                <ul>
                    <li><strong>name</strong> (required): Medication name</li>
                    <li><strong>generic_name</strong>: Generic name</li>
                    <li><strong>manufacturer</strong>: Manufacturer</li>
                    <li><strong>price</strong> (required): Price per unit</li>
                    <li><strong>stock_quantity</strong>: Initial stock quantity</li>
                    <li><strong>expiry_date</strong>: Expiry date (YYYY-MM-DD)</li>
                    <li><strong>category</strong>: Medication category</li>
                    <li><strong>barcode</strong>: Barcode (unique)</li>
                </ul>
                <p>Download the sample file to see the correct format.</p>
            </div>
        </div>
    </div>
</div>
{% endblock %}